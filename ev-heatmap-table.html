<!--
    Relative paths assume component is being run from inside an app or another component, where dependencies are flat
    siblings. When this component is run from its own repo (e.g. tests, examples), we assume the server is started with
    'gulp serve' (or similar server setup) to enable correct finding of bower dependencies for local runs.
-->
<link rel="import" href="../polymer/polymer.html"/>
<link rel="import" href="css/ev-heatmap-table-styles.html">
<link rel="import" href="../px-tooltip/px-tooltip.html">

<dom-module id="ev-heatmap-table">
  <template>
    <style include="ev-heatmap-table-styles"></style>
    <div class="table-container flex flex--row">
      <template is="dom-if" if="{{!hideRowHeader}}">
        <div class="u-pl- u-pr- table-row-header flex flex--col flex--justify">
          <template is="dom-if" if="{{showAggregation}}">
            <div class="row-header">
              <div class="row-header-text"><span>{{aggregationType}}</span></div>
            </div>
          </template>
          <template is="dom-repeat" items="{{rows}}" as="row">
            <div class="row-header" on-click="_sortRow">
              <div class="row-header-text"><span>{{_getHeader("row", index, rows)}}</span></div>
              <i class="fa fa-caret-left" hidden$="{{_sortingIcon(index,'row','up', heatmapData)}}"></i>
              <i class="fa fa-caret-right" hidden$="{{_sortingIcon(index,'row','down', heatmapData)}}"></i>
              <px-tooltip smart-orientation="true"
                          delay="100"
                          tooltip-message="{{_getHeader('fullRow', index, rows)}}"
                          hidden$="{{_getHeader('tooltipRow', index, rows)}}">
              </px-tooltip>
            </div>
          </template>
        </div>
      </template>
      <div class="table-container flex flex--row flex--left flex--top">
        <template is="dom-if" if="{{showRowAggregation}}">
          <div class="table-column">
            <div class="u-pr-- u-pb-- u-pl-- col-header" hidden$="{{hideColHeader}}">
              <div class="col-header-text"><span>{{aggregationType}}</span></div>
            </div>
            <div class="u-p-- table-empty-cell" hidden$="{{!showColAggregation}}">
              <span>&nbsp;</span>
            </div>
            <template is="dom-repeat" items="{{rowAggregatedData}}">
              <div class="u-p-- table-cell">
                <span>{{item}}</span>
              </div>
            </template>
          </div>
        </template>
        <template is="dom-repeat" items="{{heatmapData}}" as="items" id="heatmapDataRepeat">
          <div class="table-column">
            <template is="dom-if" if="{{!hideColHeader}}">
              <div class="u-pr-- u-pb-- u-pl-- col-header" on-click="_sortCol">
                <div class="col-header-text"><span>{{_getHeader("col", index, cols)}}</span></div>
                <i class="fa fa-caret-up" hidden$="{{_sortingIcon(index,'col','up',heatmapData)}}"></i>
                <i class="fa fa-caret-down" hidden$="{{_sortingIcon(index,'col','down',heatmapData)}}"></i>
                <px-tooltip smart-orientation="true"
                            delay="100"
                            tooltip-message="{{_getHeader('fullCol', index, cols)}}"
                            hidden$="{{_getHeader('tooltipCol', index, cols)}}">
                </px-tooltip>
              </div>
            </template>
            <template is="dom-if" if="{{showColAggregation}}">
              <div class="u-p-- table-cell">
                <span>{{_getColAggregation(index, colAggregatedData)}}</span>
              </div>
            </template>
            <template is="dom-repeat" items="{{items}}" as="item">
              <div class="u-p-- table-cell cell-values" style$="[[item.color]]">
                <span hidden$="{{hideValues}}">{{item.value}}</span>
                <template is="dom-if" if="{{hideValues}}">
                  <px-tooltip smart-orientation="true" delay="100" tooltip-message="{{item.value}}"></px-tooltip>
                </template>
              </div>
            </template>
          </div>
        </template>
      </div>
    </div>
  </template>
</dom-module>

<script type="text/javascript" src="js/ev-heatmap-table.js"></script>
